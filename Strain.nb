(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65445,       1718]
NotebookOptionsPosition[     61306,       1641]
NotebookOutlinePosition[     61752,       1658]
CellTagsIndexPosition[     61709,       1655]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.95199696178598*^9, 3.951997020056547*^9}, 
   3.951997052983906*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"12115c46-9df7-411b-aa6a-41a88dd5b202"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"$Path", ",", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<../\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Matte`"}]}], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"17a88629-e49d-47ba-bfc2-99d787688169"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Matte package loaded. \[CapitalAHat]\[Copyright] 2017-2018 \
Jonas Einarsson (me@jonaseinarsson.se)\"\>"], "Print",
 CellChangeTimes->{
  3.952648610889249*^9, 3.9533815320635285`*^9, 3.9536055648840017`*^9, 
   3.9536063381884413`*^9, 3.9567249167773943`*^9, 3.956724977673291*^9, {
   3.9567264874347878`*^9, 3.956726533797826*^9}, {3.9567266146763024`*^9, 
   3.956726634981103*^9}, 3.9567332415874205`*^9, 3.956745034258893*^9, 
   3.9567453455557284`*^9, 3.95679033607771*^9, 3.9567943432420325`*^9, 
   3.9573100006243997`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"85887bdc-2e12-4299-b35a-72423f8f53aa"],

Cell[BoxData["\<\"Released under the MIT License \
https://opensource.org/licenses/MIT\"\>"], "Print",
 CellChangeTimes->{
  3.952648610889249*^9, 3.9533815320635285`*^9, 3.9536055648840017`*^9, 
   3.9536063381884413`*^9, 3.9567249167773943`*^9, 3.956724977673291*^9, {
   3.9567264874347878`*^9, 3.956726533797826*^9}, {3.9567266146763024`*^9, 
   3.956726634981103*^9}, 3.9567332415874205`*^9, 3.956745034258893*^9, 
   3.9567453455557284`*^9, 3.95679033607771*^9, 3.9567943432420325`*^9, 
   3.9573100006255445`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"c187d136-075f-4970-a20d-15ed924bbf57"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Deriving Sedimentation of a particle:\n", "Chapter",
  FontWeight->"Bold"],
 StyleBox["(*Steps:  *)   (* 1.Deriving the pressure.\n                   2. \
Finding out the ansatz.\n                   3. Evaluating particluar & \
Homogenous solution.\n                        4. Evaluating the constants.\n  \
                      5. Solving for final velocity expression.*)", "Text",
  FontWeight->"Bold"]
}], "Title",
 CellChangeTimes->{{3.951997095496933*^9, 3.951997097705863*^9}, 
   3.9520002997073393`*^9, 3.9567935266306252`*^9, {3.956796941255342*^9, 
   3.9567969699073973`*^9}},ExpressionUUID->"ea46c6ce-9931-4e7f-8736-\
4786b813b00f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pansatz", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k", ",", "l"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], 
         RowBox[{"partialr", "[", 
          RowBox[{
           RowBox[{"invr", "[", "1", "]"}], ",", "j"}], "]"}]}], ")"}], 
       RowBox[{"v", "[", "j", "]"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pansatz", "//", "prettyprint"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"uhomo", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k", ",", "l"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "3", "]"}]}], ";", 
      RowBox[{"contract", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"b", "[", "1", "]"}], 
         RowBox[{"invr", "[", "1", "]"}], 
         RowBox[{"v", "[", "i", "]"}]}], "+", 
        RowBox[{
         RowBox[{"b", "[", "2", "]"}], 
         RowBox[{"partialr", "[", 
          RowBox[{
           RowBox[{"partialr", "[", 
            RowBox[{
             RowBox[{"invr", "[", "1", "]"}], ",", "i"}], "]"}], ",", "j"}], 
          "]"}], 
         RowBox[{"v", "[", "j", "]"}]}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhomo", "//", "prettyprint"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uTotalAnz", "=", 
   RowBox[{"contract", "[", 
    RowBox[{"uhomo", "+", 
     RowBox[{
      FractionBox["pansatz", 
       RowBox[{"2", "\[Mu]"}]], 
      RowBox[{"r", "[", 
       RowBox[{"idx", "[", "1", "]"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uTotalAnz", "//", "prettyprint"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Using", " ", "Continuity", " ", "Equation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ucont", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k", ",", "l"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"contract", "[", 
       RowBox[{"partialr", "[", 
        RowBox[{"uTotalAnz", ",", "i"}], "]"}], "]"}]}]}], "]"}]}], ";", 
  RowBox[{"ucont", "//", "prettyprint"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"ucont", "==", "0"}], ",", 
     RowBox[{"a", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uTotal", "=", 
   RowBox[{"uTotalAnz", "/.", "a1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uTotal", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "//", "prettyprint"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Using", " ", "Boundary", " ", "Conditions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"idx", "[", "1", "]"}]}], ";", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j", ",", "k"}], "}"}], "=", 
        RowBox[{"getNewIndex", "[", "2", "]"}]}], ";", 
       RowBox[{"contract", "[", 
        RowBox[{
         RowBox[{"uTotal", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"v", "[", "i", "]"}]}], "]"}]}]}], "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"invr", "[", "x_", "]"}], ":>", 
      RowBox[{"R", "^", 
       RowBox[{"-", "x"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BC", "//", "prettyprint"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC1", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"getScalarPrefactors", "[", "BC", "]"}], "==", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BCvar", "=", 
   RowBox[{
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Cases", "[", 
      RowBox[{"BC", ",", 
       RowBox[{
        RowBox[{"ex", ":", 
         RowBox[{"b", "[", "_Integer", "]"}]}], "->", "ex"}], ",", 
       "Infinity"}], "]"}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BCsoln", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{"BC1", ",", "BCvar"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ufinal", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"uTotal", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", "BCsoln"}], ",", "R"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ufinal", "//", "prettyprint"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pfinal", "=", 
   RowBox[{"contract", "[", 
    RowBox[{
     RowBox[{"pansatz", "/.", "a1"}], "/.", "BCsoln"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"pfinal", "//", "prettyprint"}]}], "Input",
 CellChangeTimes->{{3.952000007908533*^9, 3.952000118345691*^9}, {
   3.9520001497496753`*^9, 3.952000219163761*^9}, {3.952000337466015*^9, 
   3.95200034016543*^9}, {3.9520006614935613`*^9, 3.952000768661153*^9}, {
   3.952000804124238*^9, 3.952000900342258*^9}, {3.952000945463659*^9, 
   3.952000948229954*^9}, {3.952000986715994*^9, 3.952001012951135*^9}, {
   3.952001055247153*^9, 3.952001164076906*^9}, 3.952001243725927*^9, {
   3.9520404768063383`*^9, 3.9520404920554137`*^9}, 3.952040883219609*^9, {
   3.952041073732102*^9, 3.9520411015237327`*^9}, {3.952041155955675*^9, 
   3.95204116015481*^9}, {3.952041471890791*^9, 3.952041503671674*^9}, {
   3.952041627236242*^9, 3.952041669970246*^9}, {3.9520417621837063`*^9, 
   3.952041778064557*^9}, {3.9520418120249233`*^9, 3.952041892986295*^9}, {
   3.952065415404792*^9, 3.95206551319011*^9}, {3.952065635243746*^9, 
   3.95206565516374*^9}, {3.952066638454553*^9, 3.952066799555846*^9}, {
   3.952066833861737*^9, 3.952066889576381*^9}, {3.952066945604966*^9, 
   3.952066993971593*^9}, {3.952067840505493*^9, 3.952067855111644*^9}, {
   3.952067890388814*^9, 3.952068173277365*^9}, {3.952068219822929*^9, 
   3.9520682365160685`*^9}, {3.952068306074612*^9, 3.9520683801082935`*^9}, {
   3.95206858622965*^9, 3.952068595828225*^9}, 3.952131811108181*^9, {
   3.952132187701225*^9, 3.952132203164835*^9}, {3.952221197253678*^9, 
   3.95222119965195*^9}, {3.952581314084401*^9, 3.952581341689988*^9}, {
   3.952581375576219*^9, 3.952581377601639*^9}, {3.9525816390424843`*^9, 
   3.952581655994157*^9}, {3.952581729105954*^9, 3.9525817326494412`*^9}, 
   3.952582162932135*^9, {3.9526019719529057`*^9, 3.952601973999998*^9}, {
   3.9533815691238365`*^9, 3.9533815806768703`*^9}, {3.9567115644695206`*^9, 
   3.956711577122141*^9}, 3.9567249072392797`*^9, 3.9567263335335636`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"674ac3da-59aa-40e6-8070-90a42834d413"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"b", "[", "1", "]"}], "r"], "-", 
     FractionBox[
      RowBox[{"b", "[", "2", "]"}], 
      SuperscriptBox["r", "3"]]}], ")"}], " ", 
   SubscriptBox["v", "i"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"a", "[", "1", "]"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["r", "3"], " ", "\[Mu]"}]]}], "+", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"b", "[", "2", "]"}]}], 
      SuperscriptBox["r", "5"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["v", "j"]}]}]], "Output",
 CellChangeTimes->{
  3.9525813784798007`*^9, {3.9525816395233393`*^9, 3.952581656675585*^9}, {
   3.9525817295229645`*^9, 3.9525817331065903`*^9}, 3.9525821668756943`*^9, 
   3.952601742053514*^9, 3.952601978153441*^9, 3.952645375628507*^9, 
   3.95338153208805*^9, 3.95338156970175*^9, 3.953605564924123*^9, 
   3.9536063382074466`*^9, {3.9567249087223587`*^9, 3.9567249167922187`*^9}, 
   3.95672497769572*^9, {3.9567264874584465`*^9, 3.9567265338158503`*^9}, {
   3.9567266146934814`*^9, 3.9567266349954157`*^9}, 3.956733241606228*^9, 
   3.956745034280692*^9, 3.9567453455694246`*^9, 3.9567473878079414`*^9, 
   3.9567903361355495`*^9, 3.956794343259771*^9, 3.9573100006737556`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"ea17b6db-c8f3-489b-83ab-84ef198bbff3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"b", "[", "1", "]"}], "r"], "-", 
     FractionBox[
      RowBox[{"b", "[", "2", "]"}], 
      SuperscriptBox["r", "3"]]}], ")"}], " ", 
   SubscriptBox["v", "i"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"b", "[", "1", "]"}], 
      SuperscriptBox["r", "3"]], "+", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"b", "[", "2", "]"}]}], 
      SuperscriptBox["r", "5"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["v", "j"]}]}]], "Output",
 CellChangeTimes->{
  3.9525813784798007`*^9, {3.9525816395233393`*^9, 3.952581656675585*^9}, {
   3.9525817295229645`*^9, 3.9525817331065903`*^9}, 3.9525821668756943`*^9, 
   3.952601742053514*^9, 3.952601978153441*^9, 3.952645375628507*^9, 
   3.95338153208805*^9, 3.95338156970175*^9, 3.953605564924123*^9, 
   3.9536063382074466`*^9, {3.9567249087223587`*^9, 3.9567249167922187`*^9}, 
   3.95672497769572*^9, {3.9567264874584465`*^9, 3.9567265338158503`*^9}, {
   3.9567266146934814`*^9, 3.9567266349954157`*^9}, 3.956733241606228*^9, 
   3.956745034280692*^9, 3.9567453455694246`*^9, 3.9567473878079414`*^9, 
   3.9567903361355495`*^9, 3.956794343259771*^9, 3.9573100006839237`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"b198c8ea-84aa-4cdc-aa1d-9139908fe03f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox[
      RowBox[{"b", "[", "1", "]"}], "R"], "-", 
     FractionBox[
      RowBox[{"b", "[", "2", "]"}], 
      SuperscriptBox["R", "3"]]}], ")"}], " ", 
   SubscriptBox["v", "i"]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["R", "2"], " ", 
       RowBox[{"b", "[", "1", "]"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"b", "[", "2", "]"}]}]}], ")"}], " ", 
    SubscriptBox["r", "i"], " ", 
    SubscriptBox["r", "j"], " ", 
    SubscriptBox["v", "j"]}], 
   SuperscriptBox["R", "5"]]}]], "Output",
 CellChangeTimes->{
  3.9525813784798007`*^9, {3.9525816395233393`*^9, 3.952581656675585*^9}, {
   3.9525817295229645`*^9, 3.9525817331065903`*^9}, 3.9525821668756943`*^9, 
   3.952601742053514*^9, 3.952601978153441*^9, 3.952645375628507*^9, 
   3.95338153208805*^9, 3.95338156970175*^9, 3.953605564924123*^9, 
   3.9536063382074466`*^9, {3.9567249087223587`*^9, 3.9567249167922187`*^9}, 
   3.95672497769572*^9, {3.9567264874584465`*^9, 3.9567265338158503`*^9}, {
   3.9567266146934814`*^9, 3.9567266349954157`*^9}, 3.956733241606228*^9, 
   3.956745034280692*^9, 3.9567453455694246`*^9, 3.9567473878079414`*^9, 
   3.9567903361355495`*^9, 3.956794343259771*^9, 3.957310000687886*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"43a09d37-8262-48af-8472-ed628c52bf82"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["R", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SubscriptBox["v", "i"], 
       RowBox[{"4", " ", 
        SuperscriptBox["r", "3"]}]], "-", 
      FractionBox[
       RowBox[{"3", " ", 
        SubscriptBox["r", "i"], " ", 
        SubscriptBox["r", "j"], " ", 
        SubscriptBox["v", "j"]}], 
       RowBox[{"4", " ", 
        SuperscriptBox["r", "5"]}]]}], ")"}]}], "+", 
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"3", " ", 
        SubscriptBox["v", "i"]}], 
       RowBox[{"4", " ", "r"}]], "+", 
      FractionBox[
       RowBox[{"3", " ", 
        SubscriptBox["r", "i"], " ", 
        SubscriptBox["r", "j"], " ", 
        SubscriptBox["v", "j"]}], 
       RowBox[{"4", " ", 
        SuperscriptBox["r", "3"]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9525813784798007`*^9, {3.9525816395233393`*^9, 3.952581656675585*^9}, {
   3.9525817295229645`*^9, 3.9525817331065903`*^9}, 3.9525821668756943`*^9, 
   3.952601742053514*^9, 3.952601978153441*^9, 3.952645375628507*^9, 
   3.95338153208805*^9, 3.95338156970175*^9, 3.953605564924123*^9, 
   3.9536063382074466`*^9, {3.9567249087223587`*^9, 3.9567249167922187`*^9}, 
   3.95672497769572*^9, {3.9567264874584465`*^9, 3.9567265338158503`*^9}, {
   3.9567266146934814`*^9, 3.9567266349954157`*^9}, 3.956733241606228*^9, 
   3.956745034280692*^9, 3.9567453455694246`*^9, 3.9567473878079414`*^9, 
   3.9567903361355495`*^9, 3.956794343259771*^9, 3.957310000689889*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"fe96583a-e46e-499b-9745-12f5c143f33a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   FractionBox[
    RowBox[{"3", " ", "R", " ", "\[Mu]", " ", 
     SubscriptBox["r", "i"], " ", 
     SubscriptBox["v", "i"]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["r", "3"]}]], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9525813784798007`*^9, {3.9525816395233393`*^9, 3.952581656675585*^9}, {
   3.9525817295229645`*^9, 3.9525817331065903`*^9}, 3.9525821668756943`*^9, 
   3.952601742053514*^9, 3.952601978153441*^9, 3.952645375628507*^9, 
   3.95338153208805*^9, 3.95338156970175*^9, 3.953605564924123*^9, 
   3.9536063382074466`*^9, {3.9567249087223587`*^9, 3.9567249167922187`*^9}, 
   3.95672497769572*^9, {3.9567264874584465`*^9, 3.9567265338158503`*^9}, {
   3.9567266146934814`*^9, 3.9567266349954157`*^9}, 3.956733241606228*^9, 
   3.956745034280692*^9, 3.9567453455694246`*^9, 3.9567473878079414`*^9, 
   3.9567903361355495`*^9, 3.956794343259771*^9, 3.9573100006920605`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"30b3eeaa-ff26-4356-8132-10427586a04c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Deriving Straining:", "Chapter",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.952131877161556*^9, 3.952131878801111*^9}, {
  3.956796908936863*^9, 
  3.9567969162889853`*^9}},ExpressionUUID->"9e7cb13c-0444-487b-9787-\
e8f7b075489b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pansatzst", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k", ",", "l"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], " ", 
         RowBox[{"partialr", "[", 
          RowBox[{
           RowBox[{"partialr", "[", 
            RowBox[{
             RowBox[{"invr", "[", "1", "]"}], ",", "j"}], "]"}], ",", "k"}], 
          "]"}]}], ")"}], 
       RowBox[{"e", "[", 
        RowBox[{"j", ",", "k"}], "]"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pansatzst", "//", "prettyprint"}], "//", "contract"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uhomost", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k", ",", "l"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "3", "]"}]}], ";", 
      RowBox[{
       RowBox[{
        RowBox[{"+", 
         RowBox[{"b", "[", "1", "]"}]}], 
        RowBox[{"partialr", "[", 
         RowBox[{
          RowBox[{"invr", "[", "1", "]"}], ",", "j"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"b", "[", "2", "]"}], 
        RowBox[{"partialr", "[", 
         RowBox[{
          RowBox[{"partialr", "[", 
           RowBox[{
            RowBox[{"partialr", "[", 
             RowBox[{
              RowBox[{"invr", "[", "1", "]"}], ",", "i"}], "]"}], ",", "j"}], 
           "]"}], ",", "k"}], "]"}], 
        RowBox[{"e", "[", 
         RowBox[{"j", ",", "k"}], "]"}]}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uhomost", "//", "contract"}], "//", "prettyprint"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uTotalAnzst", "=", 
    RowBox[{
     RowBox[{"uhomost", "+", 
      RowBox[{
       FractionBox["pansatzst", 
        RowBox[{"2", "\[Mu]"}]], 
       RowBox[{"r", "[", 
        RowBox[{"idx", "[", "1", "]"}], "]"}]}]}], "//", "contract"}]}], ";", 
   RowBox[{"uTotalAnzst", "//", "prettyprint"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Using", " ", "Continuity", " ", "Equation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ucontst", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k", ",", "l"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"contract", "[", 
       RowBox[{"partialr", "[", 
        RowBox[{"uTotalAnzst", ",", "i"}], "]"}], "]"}]}]}], "]"}]}], ";", 
  RowBox[{"ucontst", "//", "prettyprint"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ucontstp", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"ucontst", ",", 
       RowBox[{
        RowBox[{"ex", ":", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", "[", "_Integer", "]"}], "|", 
           RowBox[{"a", "[", "_Integer", "]"}]}], ")"}]}], ":>", "ex"}], ",", 
       "Infinity"}], "]"}], "//", "DeleteDuplicates"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1st", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"ucontst", "==", "0"}], ",", "ucontstp"}], "]"}], "//", 
     "First"}], "//", "prettyprint"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uTotalst", "=", 
   RowBox[{
    RowBox[{"uTotalAnzst", "/.", "a1st"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"uTotalst", "//", "prettyprint"}]}], "Input",
 CellChangeTimes->{{3.9521320006980114`*^9, 3.952132137256921*^9}, {
   3.9521322154664288`*^9, 3.952132223425808*^9}, {3.952132338770649*^9, 
   3.952132350001611*^9}, {3.952132398922695*^9, 3.952132406969669*^9}, {
   3.9521324481389413`*^9, 3.952132499202707*^9}, {3.952132532473703*^9, 
   3.952132562746544*^9}, {3.952132600225704*^9, 3.9521326127045107`*^9}, {
   3.952132713809485*^9, 3.952132733170094*^9}, 3.9521327692967553`*^9, {
   3.9521328316823635`*^9, 3.952132867128578*^9}, {3.952133391704959*^9, 
   3.952133438265185*^9}, {3.9521335168411884`*^9, 3.9521335661702504`*^9}, {
   3.952133613169048*^9, 3.952133690513603*^9}, {3.9521337560247035`*^9, 
   3.9521337561691937`*^9}, {3.952134178690224*^9, 3.952134231455637*^9}, {
   3.9521376108114967`*^9, 3.952137665949834*^9}, {3.952137718440251*^9, 
   3.9521377269572377`*^9}, {3.952140539253355*^9, 3.952140584530144*^9}, 
   3.952140632140369*^9, {3.952141158980155*^9, 3.952141162817307*^9}, {
   3.9521413305482926`*^9, 3.9521414857941732`*^9}, {3.9521432776266336`*^9, 
   3.952143283250365*^9}, 3.952143403266627*^9, {3.9521434589297037`*^9, 
   3.9521434670793653`*^9}, {3.952143505002974*^9, 3.952143527143709*^9}, {
   3.952143685106758*^9, 3.9521436883689938`*^9}, {3.952143771283287*^9, 
   3.952143810713705*^9}, {3.9521440285542827`*^9, 3.9521440315209217`*^9}, {
   3.9521442116491547`*^9, 3.952144258031969*^9}, {3.9521538124342327`*^9, 
   3.9521538156877975`*^9}, {3.952221268758807*^9, 3.9522213262775044`*^9}, {
   3.952221372125407*^9, 3.9522213851979756`*^9}, 3.9522214992787704`*^9, {
   3.95222155952057*^9, 3.952221571927059*^9}, {3.952221603605216*^9, 
   3.952221687524352*^9}, {3.952221724405251*^9, 3.952221742917982*^9}, {
   3.952222357525504*^9, 3.9522223897011952`*^9}, {3.952222488381834*^9, 
   3.952222503024138*^9}, {3.952579380485688*^9, 3.952579415346418*^9}, {
   3.9525794473300714`*^9, 3.952579526291787*^9}, 3.952579931836176*^9, {
   3.952602476264736*^9, 3.9526025126163116`*^9}, {3.952602566546204*^9, 
   3.952602670418129*^9}, {3.952602708937851*^9, 3.952602773897175*^9}, {
   3.952602830413005*^9, 3.952602894687599*^9}, {3.952602953973522*^9, 
   3.952603144958693*^9}, {3.9526045721103015`*^9, 3.952604611733194*^9}, {
   3.9533814964121814`*^9, 3.953381516147419*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"7d1a2c59-7b9c-456f-8f90-ba850bc41d63"],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   RowBox[{"b", "[", "1", "]"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["e", 
    RowBox[{"i", ",", "j"}]]}], 
  SuperscriptBox["r", "5"]]], "Output",
 CellChangeTimes->{{3.952603026079056*^9, 3.9526030335926046`*^9}, {
   3.952603126987129*^9, 3.952603145790653*^9}, {3.952604575793952*^9, 
   3.952604613005264*^9}, 3.9526453756485763`*^9, 3.953381532107774*^9, 
   3.953605564943779*^9, 3.9536063382212124`*^9, 3.956724916819736*^9, 
   3.956724977711364*^9, {3.956726487486884*^9, 3.9567265338376055`*^9}, {
   3.9567266147231555`*^9, 3.956726635011275*^9}, 3.956733241634536*^9, 
   3.95674503431213*^9, 3.9567453455858717`*^9, 3.956790336175806*^9, 
   3.9567943432859516`*^9, 3.9573100007028303`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"742dada8-25d8-4d4d-ac90-ea2c27b9dd6b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"6", " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SubscriptBox["r", "j"], " ", 
    SubscriptBox["e", 
     RowBox[{"i", ",", "j"}]]}], 
   SuperscriptBox["r", "5"]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"a", "[", "1", "]"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "5"], " ", "\[Mu]"}]], "-", 
     FractionBox[
      RowBox[{"15", " ", 
       RowBox[{"b", "[", "2", "]"}]}], 
      SuperscriptBox["r", "7"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["r", "k"], " ", 
   SubscriptBox["e", 
    RowBox[{"j", ",", "k"}]]}]}]], "Output",
 CellChangeTimes->{{3.952603026079056*^9, 3.9526030335926046`*^9}, {
   3.952603126987129*^9, 3.952603145790653*^9}, {3.952604575793952*^9, 
   3.952604613005264*^9}, 3.9526453756485763`*^9, 3.953381532107774*^9, 
   3.953605564943779*^9, 3.9536063382212124`*^9, 3.956724916819736*^9, 
   3.956724977711364*^9, {3.956726487486884*^9, 3.9567265338376055`*^9}, {
   3.9567266147231555`*^9, 3.956726635011275*^9}, 3.956733241634536*^9, 
   3.95674503431213*^9, 3.9567453455858717`*^9, 3.956790336175806*^9, 
   3.9567943432859516`*^9, 3.9573100007058334`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"cd1ad532-7f77-4639-beed-df3a92fe38b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Using", " ", "Boundary", " ", "Conditions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BCst", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"idx", "[", "1", "]"}]}], ";", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j", ",", "k"}], "}"}], "=", 
          RowBox[{"getNewIndex", "[", "2", "]"}]}], ";", 
         RowBox[{"contract", "[", 
          RowBox[{"uTotalst", "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"e", "[", 
              RowBox[{"i", ",", "j"}], "]"}], 
             RowBox[{"r", "[", "j", "]"}]}], ")"}]}], "]"}]}]}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"invr", "[", "nn_", "]"}], ":>", 
        RowBox[{"R", "^", 
         RowBox[{"-", "nn"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCst", "//", "prettyprint"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BC1st", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"getScalarPrefactors", "[", "BCst", "]"}], "==", "0"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCvarst", "=", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"BCst", ",", 
         RowBox[{
          RowBox[{"ex", ":", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", "[", "_Integer", "]"}], "|", 
             RowBox[{"a", "[", "_Integer", "]"}]}], ")"}]}], ":>", "ex"}], 
         ",", "Infinity"}], "]"}], "]"}], "//", "Sort"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"BCsolnst", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"BC1st", ",", "BCvarst"}], "]"}], "//", "First"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ufinalst", "=", 
     RowBox[{"contract", "[", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{"uTotalst", "/.", "BCsolnst"}], ",", "R"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"ufinalst", "//", "prettyprint"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pfinalst", "=", 
     RowBox[{"contract", "[", 
      RowBox[{
       RowBox[{"pansatzst", "/.", "a1st"}], "/.", "BCsolnst"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"pfinalst", "//", "prettyprint"}]}]}]], "Input",
 CellChangeTimes->{{3.952140743314709*^9, 3.9521407612588873`*^9}, {
   3.952141106443591*^9, 3.952141173851786*^9}, {3.952141220268564*^9, 
   3.952141222532144*^9}, {3.9521415555708947`*^9, 3.95214161372238*^9}, {
   3.9521431048174133`*^9, 3.952143115850717*^9}, {3.952143164850769*^9, 
   3.952143200010244*^9}, {3.952143347097937*^9, 3.952143356623548*^9}, {
   3.9525795388916874`*^9, 3.952579608825979*^9}, 3.952579657417635*^9, {
   3.952581351425237*^9, 3.952581367312391*^9}, {3.952603909688001*^9, 
   3.95260394545427*^9}, {3.952604203870328*^9, 3.9526042486932087`*^9}, {
   3.952604284960548*^9, 3.952604336341296*^9}, {3.952604418342998*^9, 
   3.952604469774154*^9}, {3.9526045373432646`*^9, 3.952604541678428*^9}, {
   3.953381521594746*^9, 3.9533815269938602`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"7e9fea6d-bd1f-4be1-8720-4a63e73670ed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"5", " ", 
       SuperscriptBox["R", "3"], " ", "\[Mu]"}], "3"]}]}], ",", 
   RowBox[{
    RowBox[{"b", "[", "2", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["R", "5"], "6"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.952141179297802*^9, 3.952141187222866*^9}, {
   3.9521412275855956`*^9, 3.952141231350764*^9}, 3.952141495248562*^9, {
   3.952141556411733*^9, 3.952141579924427*^9}, 3.952143315699708*^9, 
   3.952143357130841*^9, 3.952144373645777*^9, 3.9522212056288223`*^9, 
   3.952221242006332*^9, 3.952579459159907*^9, {3.952579588893526*^9, 
   3.952579610536017*^9}, 3.952579828043171*^9, 3.952579935594562*^9, 
   3.952580504762757*^9, {3.952581358015241*^9, 3.952581368302233*^9}, 
   3.952582166898052*^9, 3.952601742072412*^9, 3.952604253355659*^9, {
   3.952604319488778*^9, 3.952604337405133*^9}, {3.952604419015869*^9, 
   3.95260447025976*^9}, 3.952604543323659*^9, 3.952604621415533*^9, 
   3.9526453756830025`*^9, 3.953381532120661*^9, 3.953605564956315*^9, 
   3.953606338231062*^9, 3.9567249168299093`*^9, 3.956724977722797*^9, {
   3.956726487496331*^9, 3.956726533847457*^9}, {3.9567266147334185`*^9, 
   3.9567266350229836`*^9}, 3.9567332416461143`*^9, 3.9567450343554764`*^9, 
   3.95674534559564*^9, 3.956790336185339*^9, 3.9567943432952404`*^9, 
   3.9573100007146077`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"fc4e546f-fa4f-462d-892e-8daf89e88925"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["R", "5"], " ", 
     SubscriptBox["r", "j"], " ", 
     SubscriptBox["e", 
      RowBox[{"i", ",", "j"}]]}], 
    SuperscriptBox["r", "5"]]}], "+", 
  RowBox[{
   FractionBox["5", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["R", "3"], 
       SuperscriptBox["r", "5"]]}], "+", 
     FractionBox[
      SuperscriptBox["R", "5"], 
      SuperscriptBox["r", "7"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["r", "k"], " ", 
   SubscriptBox["e", 
    RowBox[{"j", ",", "k"}]]}]}]], "Output",
 CellChangeTimes->{{3.952141179297802*^9, 3.952141187222866*^9}, {
   3.9521412275855956`*^9, 3.952141231350764*^9}, 3.952141495248562*^9, {
   3.952141556411733*^9, 3.952141579924427*^9}, 3.952143315699708*^9, 
   3.952143357130841*^9, 3.952144373645777*^9, 3.9522212056288223`*^9, 
   3.952221242006332*^9, 3.952579459159907*^9, {3.952579588893526*^9, 
   3.952579610536017*^9}, 3.952579828043171*^9, 3.952579935594562*^9, 
   3.952580504762757*^9, {3.952581358015241*^9, 3.952581368302233*^9}, 
   3.952582166898052*^9, 3.952601742072412*^9, 3.952604253355659*^9, {
   3.952604319488778*^9, 3.952604337405133*^9}, {3.952604419015869*^9, 
   3.95260447025976*^9}, 3.952604543323659*^9, 3.952604621415533*^9, 
   3.9526453756830025`*^9, 3.953381532120661*^9, 3.953605564956315*^9, 
   3.953606338231062*^9, 3.9567249168299093`*^9, 3.956724977722797*^9, {
   3.956726487496331*^9, 3.956726533847457*^9}, {3.9567266147334185`*^9, 
   3.9567266350229836`*^9}, 3.9567332416461143`*^9, 3.9567450343554764`*^9, 
   3.95674534559564*^9, 3.956790336185339*^9, 3.9567943432952404`*^9, 
   3.957310000716638*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"9042225e-268f-4137-82ce-6b6e53e360a5"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"5", " ", 
    SuperscriptBox["R", "3"], " ", "\[Mu]", " ", 
    SubscriptBox["r", "i"], " ", 
    SubscriptBox["r", "j"], " ", 
    SubscriptBox["e", 
     RowBox[{"i", ",", "j"}]]}], 
   SuperscriptBox["r", "5"]]}]], "Output",
 CellChangeTimes->{{3.952141179297802*^9, 3.952141187222866*^9}, {
   3.9521412275855956`*^9, 3.952141231350764*^9}, 3.952141495248562*^9, {
   3.952141556411733*^9, 3.952141579924427*^9}, 3.952143315699708*^9, 
   3.952143357130841*^9, 3.952144373645777*^9, 3.9522212056288223`*^9, 
   3.952221242006332*^9, 3.952579459159907*^9, {3.952579588893526*^9, 
   3.952579610536017*^9}, 3.952579828043171*^9, 3.952579935594562*^9, 
   3.952580504762757*^9, {3.952581358015241*^9, 3.952581368302233*^9}, 
   3.952582166898052*^9, 3.952601742072412*^9, 3.952604253355659*^9, {
   3.952604319488778*^9, 3.952604337405133*^9}, {3.952604419015869*^9, 
   3.95260447025976*^9}, 3.952604543323659*^9, 3.952604621415533*^9, 
   3.9526453756830025`*^9, 3.953381532120661*^9, 3.953605564956315*^9, 
   3.953606338231062*^9, 3.9567249168299093`*^9, 3.956724977722797*^9, {
   3.956726487496331*^9, 3.956726533847457*^9}, {3.9567266147334185`*^9, 
   3.9567266350229836`*^9}, 3.9567332416461143`*^9, 3.9567450343554764`*^9, 
   3.95674534559564*^9, 3.956790336185339*^9, 3.9567943432952404`*^9, 
   3.9573100007176394`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"4bb66611-9cba-4fb1-a317-2fa5a7b1a4d4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Evaluating Force of a Settling Particle:\n", "Chapter",
  FontWeight->"Bold",
  FontVariations->{"Underline"->True}],
 StyleBox["Steps:   1.Evaluating the Shear rate.\n                   2. \
Finding out the stress.\n                   3. Integrating the stress to find \
the force.", "Text",
  FontWeight->"Bold"]
}], "Title",
 CellChangeTimes->{{3.9525799562911634`*^9, 3.952579990318272*^9}, {
  3.952581107954959*^9, 3.952581143419754*^9}, {3.952581237982105*^9, 
  3.9525812816679792`*^9}, {3.952583116129119*^9, 3.952583116434611*^9}, {
  3.9567968608524995`*^9, 3.956796876193311*^9}, {3.956797017030384*^9, 
  3.9567970195035267`*^9}, {3.9567970574060593`*^9, 
  3.956797090142903*^9}},ExpressionUUID->"ccb38825-6489-430a-8104-\
2dbbf66604ea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"uTotalAnz", "=", 
   RowBox[{"uhomo", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pansatz", "/", 
       RowBox[{"(", 
        RowBox[{"2", "\[Mu]"}], ")"}]}], ")"}], 
     RowBox[{"r", "[", 
      RowBox[{"idx", "[", "1", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uTotalAnz", "//", "contract"}], "//", "prettyprint"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graduS", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{"j", "=", 
       RowBox[{"idx", "[", "2", "]"}]}], ";", 
      RowBox[{"k", "=", 
       RowBox[{"idx", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partialr", "[", 
       RowBox[{"uTotalAnz", ",", "k"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"graduS", "//", "contract"}], "//", "prettyprint"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"graduST", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{"j", "=", 
       RowBox[{"idx", "[", "2", "]"}]}], ";", 
      RowBox[{"k", "=", 
       RowBox[{"idx", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partialr", "[", 
       RowBox[{
        RowBox[{"uTotalAnz", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"idx", "[", "1", "]"}], "->", 
           RowBox[{"idx", "[", "3", "]"}]}], "}"}]}], ",", "i"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"graduST", "//", "contract"}], "//", "prettyprint"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"stressAnz", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{"j", "=", 
       RowBox[{"idx", "[", "2", "]"}]}], ";", 
      RowBox[{"k", "=", 
       RowBox[{"idx", "[", "3", "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l", ",", "m"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "2", "]"}]}], ";", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "pansatz"}], " ", 
            RowBox[{"(", 
             RowBox[{"delta", "[", 
              RowBox[{"i", ",", "k"}], "]"}], ")"}]}], "+", 
           RowBox[{"\[Mu]", 
            RowBox[{"(", 
             RowBox[{"graduS", "+", "graduST"}], ")"}]}]}], "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"invr", "[", "nn_", "]"}], ":>", 
            RowBox[{"R", "^", 
             RowBox[{"-", "nn"}]}]}], "]"}]}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"r", "[", "i", "]"}], ":>", 
           RowBox[{"R", " ", 
            RowBox[{"n", "[", "i", "]"}]}]}], "]"}]}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"r", "[", "j", "]"}], ":>", 
          RowBox[{"R", " ", 
           RowBox[{"n", "[", "j", "]"}]}]}], "]"}]}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"r", "[", "k", "]"}], ":>", 
         RowBox[{"R", " ", 
          RowBox[{"n", "[", "k", "]"}]}]}], "]"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"stressAnz1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"stressAnz", "/.", "a1"}], "/.", "BCsoln"}], "//", "contract"}],
     "//", "prettyprint"}], "//", "Flatten"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "To", " ", "substitute", " ", "and", " ", "extract", " ", "the", " ", 
    "dimensions", " ", "of", " ", "r", " ", "out", " ", "we", " ", 
    "substituted", " ", "like", " ", "this"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.952648200335072*^9, 3.952648236715068*^9}, {
   3.9526482972261133`*^9, 3.9526482998197412`*^9}, {3.952648330158485*^9, 
   3.952648355102941*^9}, {3.952648393170197*^9, 3.952648400984747*^9}, 
   3.952648433750576*^9, {3.952648529108589*^9, 3.952648553674016*^9}, {
   3.9526486344492807`*^9, 3.952648671132742*^9}, {3.952648706410101*^9, 
   3.952648707395523*^9}, {3.952648749987116*^9, 3.9526487744350452`*^9}, {
   3.952648920369095*^9, 3.9526489252743998`*^9}, 3.952649250219965*^9, 
   3.953382079991454*^9, {3.953382111434723*^9, 3.9533821299460573`*^9}, {
   3.953382160380536*^9, 3.953382213994089*^9}, {3.9533828527633266`*^9, 
   3.9533828572415543`*^9}, 3.9533828943075547`*^9, {3.9536055542489285`*^9, 
   3.9536055590188293`*^9}, {3.9567332501280675`*^9, 
   3.9567333126282716`*^9}, {3.956798732465742*^9, 3.9567987716528683`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"32227497-5bab-4c97-99c0-a8c438fa564b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"3", " ", "\[Mu]", " ", 
      SubscriptBox["n", "k"], " ", 
      SubscriptBox["v", "i"]}], 
     RowBox[{"2", " ", "R"}]]}], "-", 
   FractionBox[
    RowBox[{"9", " ", "\[Mu]", " ", 
     SubscriptBox["n", "i"], " ", 
     SubscriptBox["n", "k"], " ", 
     SubscriptBox["r", "i"], " ", 
     SubscriptBox["v", "i"]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["R", "2"]}]], "+", 
   FractionBox[
    RowBox[{"15", " ", "\[Mu]", " ", 
     SubscriptBox["n", "i"], " ", 
     SubscriptBox["n", "j"], " ", 
     SubscriptBox["n", "k"], " ", 
     SubscriptBox["v", "j"]}], 
    RowBox[{"2", " ", "R"}]], "-", 
   FractionBox[
    RowBox[{"3", " ", "\[Mu]", " ", 
     SubscriptBox["n", "i"], " ", 
     SubscriptBox["v", "k"]}], 
    RowBox[{"2", " ", "R"}]], "-", 
   FractionBox[
    RowBox[{"3", " ", "\[Mu]", " ", 
     SubscriptBox["n", "j"], " ", 
     SubscriptBox["v", "j"], " ", 
     SubscriptBox["\[Delta]", 
      RowBox[{"i", ",", "k"}]]}], 
    RowBox[{"2", " ", "R"}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.953382170556337*^9, 3.9533822150844264`*^9, 3.9533828640990095`*^9, 
   3.953382895367099*^9, {3.953605561246954*^9, 3.95360556497377*^9}, 
   3.953606338253825*^9, 3.956724916854725*^9, 3.956724977747486*^9, {
   3.956726487514635*^9, 3.956726533864725*^9}, {3.956726614755109*^9, 
   3.9567266350406575`*^9}, 3.95673324166617*^9, 3.95673331372112*^9, 
   3.9567450343831496`*^9, 3.9567453456182175`*^9, 3.9567903362072277`*^9, 
   3.956794343316741*^9, 3.9573100007328386`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"7ed301d5-620b-4d02-9e0e-9b0860ba45ee"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Sedimentation+ Straining ", "Subtitle",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.9567465127822533`*^9, 3.9567465255504208`*^9}, {
   3.956794016223508*^9, 3.9567940199258776`*^9}, 3.9567940592171726`*^9, 
   3.956794124501069*^9, {3.9567968005299473`*^9, 3.956796814952776*^9}, {
   3.956797100653945*^9, 
   3.9567971108859825`*^9}},ExpressionUUID->"d3921d91-98d5-4cbd-9aac-\
b0f105dacd37"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pansatzstd", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k", ",", "l"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], 
         RowBox[{"partialr", "[", 
          RowBox[{
           RowBox[{"invr", "[", "1", "]"}], ",", "j"}], "]"}], 
         RowBox[{"v", "[", "j", "]"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", "2", "]"}], 
         RowBox[{"partialr", "[", 
          RowBox[{
           RowBox[{"partialr", "[", 
            RowBox[{
             RowBox[{"invr", "[", "1", "]"}], ",", "j"}], "]"}], ",", "k"}], 
          "]"}], 
         RowBox[{"e", "[", 
          RowBox[{"j", ",", "k"}], "]"}]}], ")"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pansatzstd", "//", "contract"}], "//", "prettyprint"}]}], "Input",
 CellChangeTimes->{{3.9567479683484716`*^9, 3.9567479861307983`*^9}, {
   3.956790273151927*^9, 3.9567902739362245`*^9}, {3.956790948982294*^9, 
   3.9567909511896896`*^9}, 3.956794048433962*^9, {3.956794078554315*^9, 
   3.9567941009375477`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"37e00f3e-da48-447f-86ed-36bb15a1e714"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], " ", 
     SubscriptBox["r", "i"], " ", 
     SubscriptBox["v", "i"]}], 
    SuperscriptBox["r", "3"]]}], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    SubscriptBox["r", "i"], " ", 
    SubscriptBox["r", "j"], " ", 
    SubscriptBox["e", 
     RowBox[{"i", ",", "j"}]]}], 
   SuperscriptBox["r", "5"]]}]], "Output",
 CellChangeTimes->{3.9567479887088075`*^9, 3.956790336217675*^9, 
  3.9567909533541284`*^9, 3.956794343326866*^9, 3.957310000743537*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"5d3a991e-2253-461d-944d-70d4f9da8935"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"uhomostd", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"idx", "[", "1", "]"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "k", ",", "l"}], "}"}], "=", 
       RowBox[{"getNewIndex", "[", "3", "]"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", "[", "1", "]"}], 
         RowBox[{"invr", "[", "1", "]"}], 
         RowBox[{"v", "[", "i", "]"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", "[", "2", "]"}], 
         RowBox[{"partialr", "[", 
          RowBox[{
           RowBox[{"partialr", "[", 
            RowBox[{
             RowBox[{"invr", "[", "1", "]"}], ",", "i"}], "]"}], ",", "j"}], 
          "]"}], 
         RowBox[{"v", "[", "j", "]"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", "[", "3", "]"}], 
         RowBox[{"partialr", "[", 
          RowBox[{
           RowBox[{"invr", "[", "1", "]"}], ",", "j"}], "]"}], 
         RowBox[{"e", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", "[", "4", "]"}], 
         RowBox[{"partialr", "[", 
          RowBox[{
           RowBox[{"partialr", "[", 
            RowBox[{
             RowBox[{"partialr", "[", 
              RowBox[{
               RowBox[{"invr", "[", "1", "]"}], ",", "i"}], "]"}], ",", "j"}],
             "]"}], ",", "k"}], "]"}], 
         RowBox[{"e", "[", 
          RowBox[{"j", ",", "k"}], "]"}]}], ")"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uhomostd", "//", "contract"}], "//", "prettyprint"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uTotalAnzstd", "=", 
   RowBox[{
    RowBox[{"uhomostd", "+", 
     RowBox[{
      FractionBox["pansatzstd", 
       RowBox[{"2", "\[Mu]"}]], 
      RowBox[{"r", "[", 
       RowBox[{"idx", "[", "1", "]"}], "]"}]}]}], "//", "contract"}]}], ";", 
  RowBox[{"uTotalAnzstd", "//", "prettyprint"}]}]}], "Input",
 CellChangeTimes->{
  3.956790255117034*^9, {3.9567906753349595`*^9, 3.956790709134444*^9}, {
   3.9567907549184647`*^9, 3.9567908223589325`*^9}, {3.956790931502198*^9, 
   3.956790960317554*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"240c63a6-2503-4567-84f3-bd0e251a3e85"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"b", "[", "1", "]"}], "r"], "-", 
     FractionBox[
      RowBox[{"b", "[", "2", "]"}], 
      SuperscriptBox["r", "3"]]}], ")"}], " ", 
   SubscriptBox["v", "i"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"a", "[", "1", "]"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["r", "3"], " ", "\[Mu]"}]]}], "+", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"b", "[", "2", "]"}]}], 
      SuperscriptBox["r", "5"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["v", "j"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"b", "[", "3", "]"}], 
       SuperscriptBox["r", "3"]]}], "+", 
     FractionBox[
      RowBox[{"6", " ", 
       RowBox[{"b", "[", "4", "]"}]}], 
      SuperscriptBox["r", "5"]]}], ")"}], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["e", 
    RowBox[{"i", ",", "j"}]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"a", "[", "2", "]"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "5"], " ", "\[Mu]"}]], "-", 
     FractionBox[
      RowBox[{"15", " ", 
       RowBox[{"b", "[", "4", "]"}]}], 
      SuperscriptBox["r", "7"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["r", "k"], " ", 
   SubscriptBox["e", 
    RowBox[{"j", ",", "k"}]]}]}]], "Output",
 CellChangeTimes->{3.9567909609043417`*^9, 3.9567943433355494`*^9, 
  3.957310000754032*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"65d3d32f-476f-4ff4-8218-b0c6337d1197"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Using", " ", "Continuity", " ", "Equation"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ucontstd", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
       RowBox[{
        RowBox[{"i", "=", 
         RowBox[{"idx", "[", "1", "]"}]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j", ",", "k", ",", "l"}], "}"}], "=", 
         RowBox[{"getNewIndex", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"contract", "[", 
         RowBox[{"partialr", "[", 
          RowBox[{"uTotalAnzstd", ",", "i"}], "]"}], "]"}]}]}], "]"}]}], ";", 
    RowBox[{"ucontstd", "//", "prettyprint"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uconteqns", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"getScalarPrefactors", "[", "ucontstd", "]"}], "==", "0"}], "//",
       "Thread"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Here", " ", "we", " ", "needed", " ", "this", " ", "function", " ", 
     "getscalarprefactors", " ", "as", " ", "due", " ", "to", " ", 
     "complexity", " ", "we", " ", "cannot", " ", "solve", " ", "directly", 
     " ", "the", " ", "continuity", " ", "solution", " ", "of", " ", 
     "velocity", " ", "ansatz"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ucontstdp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"ucontstd", ",", 
         RowBox[{
          RowBox[{"ex", ":", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", "[", "_Integer", "]"}], "|", 
             RowBox[{"a", "[", "_Integer", "]"}]}], ")"}]}], ":>", "ex"}], 
         ",", "Infinity"}], "]"}], "//", "DeleteDuplicates"}], "//", 
      "Sort"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a1std", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{"uconteqns", ",", "ucontstdp"}], "]"}], "//", "First"}], "//",
       "prettyprint"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uTotalstd", "=", 
     RowBox[{
      RowBox[{"uTotalAnzstd", "/.", "a1std"}], "//", "Flatten"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"uTotalstd", "//", "prettyprint"}]}]}]], "Input",
 CellChangeTimes->{{3.956791059101655*^9, 3.9567911120143385`*^9}, {
   3.95679114762142*^9, 3.956791149141388*^9}, {3.956791232961893*^9, 
   3.9567914146053505`*^9}, 3.9567927038417163`*^9, {3.9567927590827723`*^9, 
   3.9567928041900654`*^9}, {3.9567928614273815`*^9, 
   3.9567929139843545`*^9}, {3.956792967904986*^9, 3.956793048207944*^9}, 
   3.956793093537695*^9, {3.956793157899213*^9, 3.956793175808646*^9}, {
   3.9567985381865826`*^9, 3.9567986291076846`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"7cff3bd7-ae8e-4432-bd2b-9814cc955866"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    58, 1, 28766929369581301464, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.956791114247718*^9, {3.956791150310066*^9, 3.956791153126217*^9}, {
   3.9567912342850513`*^9, 3.956791237363132*^9}, {3.9567913641484747`*^9, 
   3.95679141513072*^9}, 3.95679270445619*^9, 3.956792805449295*^9, {
   3.9567929855033956`*^9, 3.9567929981393113`*^9}, 3.956793107332526*^9, {
   3.956793162946477*^9, 3.9567931762860947`*^9}, 3.9567943433439283`*^9, 
   3.9573100007919664`*^9},
 CellLabel->
  "During evaluation of \
In[55]:=",ExpressionUUID->"a90240a6-095f-42a3-804f-288a9a34d054"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"a", "[", "1", "]"}], 
       RowBox[{"2", " ", "r", " ", "\[Mu]"}]]}], "-", 
     FractionBox[
      RowBox[{"b", "[", "2", "]"}], 
      SuperscriptBox["r", "3"]]}], ")"}], " ", 
   SubscriptBox["v", "i"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"a", "[", "1", "]"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["r", "3"], " ", "\[Mu]"}]]}], "+", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"b", "[", "2", "]"}]}], 
      SuperscriptBox["r", "5"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["v", "j"]}], "+", 
  FractionBox[
   RowBox[{"6", " ", 
    RowBox[{"b", "[", "4", "]"}], " ", 
    SubscriptBox["r", "j"], " ", 
    SubscriptBox["e", 
     RowBox[{"i", ",", "j"}]]}], 
   SuperscriptBox["r", "5"]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"a", "[", "2", "]"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "5"], " ", "\[Mu]"}]], "-", 
     FractionBox[
      RowBox[{"15", " ", 
       RowBox[{"b", "[", "4", "]"}]}], 
      SuperscriptBox["r", "7"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["r", "k"], " ", 
   SubscriptBox["e", 
    RowBox[{"j", ",", "k"}]]}]}]], "Output",
 CellChangeTimes->{3.956793176289976*^9, 3.9567943433489327`*^9, 
  3.9573100008032694`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"2edf5531-506d-4ea2-9b81-80f25fecee88"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Using", " ", "Boundary", " ", "Conditions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BCstd", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"idx", "[", "1", "]"}]}], ";", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j", ",", "k"}], "}"}], "=", 
          RowBox[{"getNewIndex", "[", "2", "]"}]}], ";", 
         RowBox[{"contract", "[", 
          RowBox[{"uTotalstd", "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"e", "[", 
              RowBox[{"i", ",", "j"}], "]"}], 
             RowBox[{"r", "[", "j", "]"}]}], ")"}], "-", 
           RowBox[{"v", "[", "i", "]"}]}], "]"}]}]}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"invr", "[", "nn_", "]"}], ":>", 
        RowBox[{"R", "^", 
         RowBox[{"-", "nn"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCstd", "//", "prettyprint"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BC1std", "=", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"getScalarPrefactors", "[", "BCstd", "]"}], "==", "0"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCvarstd", "=", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"BCstd", ",", 
         RowBox[{
          RowBox[{"ex", ":", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", "[", "_Integer", "]"}], "|", 
             RowBox[{"a", "[", "_Integer", "]"}]}], ")"}]}], ":>", "ex"}], 
         ",", "Infinity"}], "]"}], "]"}], "//", "Sort"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"BCsolnstd", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"BC1std", ",", "BCvarstd"}], "]"}], "//", "First"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ufinalstd", "=", 
     RowBox[{"contract", "[", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{"uTotalstd", "/.", "BCsolnstd"}], ",", "R"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"ufinalstd", "//", "prettyprint"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pfinalstd", "=", 
     RowBox[{"contract", "[", 
      RowBox[{
       RowBox[{"pansatzstd", "/.", "a1std"}], "/.", "BCsolnstd"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"pfinalstd", "//", "prettyprint"}]}]}]], "Input",
 CellChangeTimes->{{3.9567932302885485`*^9, 3.9567932328817525`*^9}, {
  3.956793868647685*^9, 3.956793969302226*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"8aff57f1-2fd4-4721-8a97-514053a66dcf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", "R", " ", "\[Mu]"}], "2"]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"5", " ", 
       SuperscriptBox["R", "3"], " ", "\[Mu]"}], "3"]}]}], ",", 
   RowBox[{
    RowBox[{"b", "[", "2", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["R", "3"], "4"]}]}], ",", 
   RowBox[{
    RowBox[{"b", "[", "4", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["R", "5"], "6"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.95679397291074*^9, 3.9567943433569546`*^9, 
  3.9573100008139224`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"3ac16548-bf63-4ce7-8240-383d6cb59262"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", "R"}], "r"], "+", 
     FractionBox[
      SuperscriptBox["R", "3"], 
      SuperscriptBox["r", "3"]]}], ")"}], " ", 
   SubscriptBox["v", "i"]}], "+", 
  RowBox[{
   FractionBox["3", "4"], " ", "R", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["r", "3"]], "-", 
     FractionBox[
      SuperscriptBox["R", "2"], 
      SuperscriptBox["r", "5"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["v", "j"]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["R", "5"], " ", 
    SubscriptBox["r", "j"], " ", 
    SubscriptBox["e", 
     RowBox[{"i", ",", "j"}]]}], 
   SuperscriptBox["r", "5"]], "+", 
  RowBox[{
   FractionBox["5", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["R", "3"], 
       SuperscriptBox["r", "5"]]}], "+", 
     FractionBox[
      SuperscriptBox["R", "5"], 
      SuperscriptBox["r", "7"]]}], ")"}], " ", 
   SubscriptBox["r", "i"], " ", 
   SubscriptBox["r", "j"], " ", 
   SubscriptBox["r", "k"], " ", 
   SubscriptBox["e", 
    RowBox[{"j", ",", "k"}]]}]}]], "Output",
 CellChangeTimes->{3.95679397291074*^9, 3.9567943433569546`*^9, 
  3.9573100008159223`*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"497cad13-436f-4a42-893a-1fdc02de4221"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"3", " ", "R", " ", "\[Mu]", " ", 
    SubscriptBox["r", "i"], " ", 
    SubscriptBox["v", "i"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "3"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    SuperscriptBox["R", "3"], " ", "\[Mu]", " ", 
    SubscriptBox["r", "i"], " ", 
    SubscriptBox["r", "j"], " ", 
    SubscriptBox["e", 
     RowBox[{"i", ",", "j"}]]}], 
   SuperscriptBox["r", "5"]]}]], "Output",
 CellChangeTimes->{3.95679397291074*^9, 3.9567943433569546`*^9, 
  3.9573100008199835`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"75f6ae12-1497-4248-803c-3bd8630abe84"]
}, Open  ]]
}, Open  ]],

Cell[TextData[StyleBox["", "Text",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.9567942442357693`*^9, 3.9567942846921864`*^9}, {
   3.9567967514937057`*^9, 3.9567967521011376`*^9}, {3.9567971256701756`*^9, 
   3.9567971299895096`*^9}, {3.9567972546556816`*^9, 3.956797265805558*^9}, 
   3.9567973653735237`*^9, 3.9567974181563177`*^9, 
   3.9567975669090867`*^9},ExpressionUUID->"a59c4030-8405-471b-ae4c-\
300fee773bbf"]
},
WindowSize->{1428., 735.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c971f312-58c5-4ee4-adc4-da50a1893611"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 245, 4, 28, "Input",ExpressionUUID->"12115c46-9df7-411b-aa6a-41a88dd5b202"],
Cell[CellGroupData[{
Cell[828, 28, 319, 8, 48, "Input",ExpressionUUID->"17a88629-e49d-47ba-bfc2-99d787688169"],
Cell[CellGroupData[{
Cell[1172, 40, 655, 11, 22, "Print",ExpressionUUID->"85887bdc-2e12-4299-b35a-72423f8f53aa"],
Cell[1830, 53, 624, 11, 22, "Print",ExpressionUUID->"c187d136-075f-4970-a20d-15ed924bbf57"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2503, 70, 672, 12, 199, "Title",ExpressionUUID->"ea46c6ce-9931-4e7f-8736-4786b813b00f"],
Cell[CellGroupData[{
Cell[3200, 86, 7452, 192, 488, "Input",ExpressionUUID->"674ac3da-59aa-40e6-8070-90a42834d413"],
Cell[10655, 280, 1475, 36, 52, "Output",ExpressionUUID->"ea17b6db-c8f3-489b-83ab-84ef198bbff3"],
Cell[12133, 318, 1409, 34, 49, "Output",ExpressionUUID->"b198c8ea-84aa-4cdc-aa1d-9139908fe03f"],
Cell[13545, 354, 1443, 35, 53, "Output",ExpressionUUID->"43a09d37-8262-48af-8472-ed628c52bf82"],
Cell[14991, 391, 1663, 42, 50, "Output",ExpressionUUID->"fe96583a-e46e-499b-9745-12f5c143f33a"],
Cell[16657, 435, 1023, 19, 49, "Output",ExpressionUUID->"30b3eeaa-ff26-4356-8132-10427586a04c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17729, 460, 265, 5, 84, "Title",ExpressionUUID->"9e7cb13c-0444-487b-9787-e8f7b075489b"],
Cell[CellGroupData[{
Cell[18019, 469, 6616, 160, 318, "Input",ExpressionUUID->"7d1a2c59-7b9c-456f-8f90-ba850bc41d63"],
Cell[24638, 631, 884, 17, 50, "Output",ExpressionUUID->"742dada8-25d8-4d4d-ac90-ea2c27b9dd6b"],
Cell[25525, 650, 1366, 34, 53, "Output",ExpressionUUID->"cd1ad532-7f77-4639-beed-df3a92fe38b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26928, 689, 3389, 85, 201, "Input",ExpressionUUID->"7e9fea6d-bd1f-4be1-8720-4a63e73670ed"],
Cell[30320, 776, 1564, 30, 50, "Output",ExpressionUUID->"fc4e546f-fa4f-462d-892e-8daf89e88925"],
Cell[31887, 808, 1873, 42, 55, "Output",ExpressionUUID->"9042225e-268f-4137-82ce-6b6e53e360a5"],
Cell[33763, 852, 1468, 26, 52, "Output",ExpressionUUID->"4bb66611-9cba-4fb1-a317-2fa5a7b1a4d4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35280, 884, 778, 15, 153, "Title",ExpressionUUID->"ccb38825-6489-430a-8104-2dbbf66604ea"],
Cell[CellGroupData[{
Cell[36083, 903, 5048, 136, 314, "Input",ExpressionUUID->"32227497-5bab-4c97-99c0-a8c438fa564b"],
Cell[41134, 1041, 1677, 44, 50, "Output",ExpressionUUID->"7ed301d5-620b-4d02-9e0e-9b0860ba45ee"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42860, 1091, 428, 7, 71, "Title",ExpressionUUID->"d3921d91-98d5-4cbd-9aac-b0f105dacd37"],
Cell[CellGroupData[{
Cell[43313, 1102, 1527, 40, 67, "Input",ExpressionUUID->"37e00f3e-da48-447f-86ed-36bb15a1e714"],
Cell[44843, 1144, 676, 19, 50, "Output",ExpressionUUID->"5d3a991e-2253-461d-944d-70d4f9da8935"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45556, 1168, 2444, 70, 146, "Input",ExpressionUUID->"240c63a6-2503-4567-84f3-bd0e251a3e85"],
Cell[48003, 1240, 1760, 59, 52, "Output",ExpressionUUID->"65d3d32f-476f-4ff4-8218-b0c6337d1197"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49800, 1304, 2892, 70, 182, "Input",ExpressionUUID->"7cff3bd7-ae8e-4432-bd2b-9814cc955866"],
Cell[52695, 1376, 734, 15, 28, "Message",ExpressionUUID->"a90240a6-095f-42a3-804f-288a9a34d054"],
Cell[53432, 1393, 1646, 54, 53, "Output",ExpressionUUID->"2edf5531-506d-4ea2-9b81-80f25fecee88"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55115, 1452, 2790, 77, 201, "Input",ExpressionUUID->"8aff57f1-2fd4-4721-8a97-514053a66dcf"],
Cell[57908, 1531, 847, 26, 50, "Output",ExpressionUUID->"3ac16548-bf63-4ce7-8240-383d6cb59262"],
Cell[58758, 1559, 1449, 49, 55, "Output",ExpressionUUID->"497cad13-436f-4a42-893a-1fdc02de4221"],
Cell[60210, 1610, 636, 18, 52, "Output",ExpressionUUID->"75f6ae12-1497-4248-803c-3bd8630abe84"]
}, Open  ]]
}, Open  ]],
Cell[60873, 1632, 429, 7, 60, "Title",ExpressionUUID->"a59c4030-8405-471b-ae4c-300fee773bbf"]
}
]
*)

